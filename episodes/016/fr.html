<p>Ci-dessous, on a un formulaire d'enregistrement qui prend un prénom, un nom et un mot de passe.</p>

<img src="/system/photos/12/original/E016I01.png" width="625" height="445"/>  
<p>Ces champs sont aussi dans la structure de notre base de données :</p>
<pre class="ruby">
create_table "users", :force => true do |t|
  t.string   "first_name"
  t.string   "last_name"
  t.string   "password"
end
</pre>
<p>Mais que se passe-t-il si on veut changer l'interface utilisateur qui ferait qu'on aurait un champ <code>full_name</code> au lieu de champs pour <code>first_name</code> et <code>last_name</code> ? On peut faire ça en utilisant un attribut virtuel (<em>virtual attribute</em>). Premièrement, nous allons changer le code de notre vue et combiner les champs des deux noms.</p>
<pre class="ruby">
&lt;h1&gt;Register&lt;/h1&gt;
&lt;% form_for @user do |form| %&gt;
&lt;ol class="formList"&gt;
  &lt;li&gt;
    &lt;%= form.label :full_name, 'Nom complet' %&gt;
    &lt;%= form.text_field :full_name %&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;%= form.label :password, 'Mot de passe' %&gt;
    &lt;%= form.password_field :password %&gt;
  &lt;/li&gt;
&lt;/ol&gt;
&lt;% end %&gt;
</pre>
<p class="title"><code>new.html.erb</code> avec le champ <code>full_name</code> en place.</p>
<p>Maintenant, quand nous soumettons le formulaire, l'application cherchera un attribut <code>full_name</code> dans le modèle  <code>User</code>, qui ne l'a pas encore. Nous pouvons le créer en définissant un attribut virtuel pour <code>full_name</code>.</p>
<pre class="ruby">
class User &lt; ActiveRecord::Base
  # Getter
  def full_name
    [first_name, last_name].join(' ')
  end

  # Setter
  def full_name=(name)
    split = name.split(' ', 2)
    self.first_name = split.first
    self.last_name = split.last
  end
end
</pre>
<p class="title">Les méthodes getter et setter définies dans le modèle <code>User</code>.</p>
<p>La méthode getter récupère les valeurs de <code>first_name</code> et <code>last_name</code> pour l'utilisateur et les retourne, jointes par un espace. La méthode setter sépare la valeur passée au niveau du premier espace et définie le <code>first_name</code> et le <code>last_name</code> comme étant la première et la seconde partie de la chaine divisée.</p>
<p>Utiliser des propriétés virtuelles signifie que l'interface utilisateur doit avoir un champ qui correspond à chaque champ de la table correspondante. C'est particulièrement utile quand vous utilisez Rails pour vous connecter à une base de données et que vous ne pouvez pas altérer les champs de ses tables.</p>
<h3>Voir ça en action</h3>
<p>Nous allons essayer notre nouveau formulaire et voir si ça fonctionne. On va saisir &ldquo;John Smith&rdquo; comme nom complet et &ldquo;secret&rdquo; comme mot de passe.</p>
<pre class="terminal">
  Processing UsersController#create (for 127.0.0.1 at 2009-01-10 21:55:44) [POST]
    Parameters: {"user"=>{"password"=>"secret", "full_name"=>" John Smith"}, "commit"=>"Add user", "authenticity_token"=>"6990f4ad21cb4f9c812a6f10ceef51faa4f46ce7"}
    User Create (0.4ms)   INSERT INTO "users" ("first_name", "last_name", "password") VALUES('John', 'Smith', 'secret')
</pre>
<p class="title">Partie des logs de développement montrant le nouvel utilisateur étant ajouté à la base de données.</p>
<p>On peut voir à partir des logs de développements précédents que le nom complet a été envoyé à l'action <code>create</code> (et ensuite au modèle <code>User</code>), mais que le prénom et le nom sont séparés.</p>
<p>Les attributs virtuels fournissent un moyen puissant et flexible pour vous permettre de personnaliser votre interface utilisateur.</p>