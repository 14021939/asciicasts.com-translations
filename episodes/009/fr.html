<p>Ci-dessous, nous avons un formulaire d'enregistrement utilisateur. Remplissons le et enregistrons.</p>
<img src="/system/photos/7/original/E009I01.png" title="Entering sensitive data in a form" alt="Entering sensitive data in a form" width="800" height="500" />
<p>Si on regarde les logs de développement, on peut voir que tous les paramètres que nous transmettons grâce au formulaire sont stocké en texte plein.</p>
<pre class="terminal">
Processing UsersController#create (for 127.0.0.1 at 2009-01-02 10:13:13) [POST]
Parameters: {"user"=&gt;{"name"=&gt;"eifion", "password_confirmation"=&gt;"secret", "password"=&gt;"secret"}, "commit"=&gt;"Register", "authenticity_token"=&gt;"9efc03bcc37191d8a6dc3676e2e7890ecdfda0b5"}
User Create (0.5ms)   INSERT INTO "users" ("name", "updated_at", "password_confirmation", "password", "created_at") VALUES('eifion', '2009-01-02 10:13:13', 'secret', 'secret', '2009-01-02 10:13:13')
</pre>
<p>Les valeurs que nous avons saisi dans le formulaire sont clairement visible dans le fichier de log et ceci augmente évidemment les problèmes de sécurité. Rails 1.2 a introduit la commande <code>filter_parameter_logging</code>. En mettant cette commande dans le contrôleur <code>ApplicationController</code> nous permet de filtrer les paramètres basé sur leurs noms :</p>
<pre class="ruby">
class ApplicationController &lt; ActionController::Base
  filter_parameter_logging "password"
end
</pre>
<p>Les versions supérieures de Rails ont cette ligne dans le contrôleur de l'application par défaut mais elle est commentée donc il faut la décommenter pour l'utiliser. Nous allons créer un autre utilisateur et voir ce qu'il y a dans les logs.</p>
<pre class="terminal">
Processing UsersController#create (for 127.0.0.1 at 2009-01-02 11:02:33) [POST]
  Parameters: {"user"=&gt;{"name"=&gt;"susan", "password_confirmation"=&gt;"[FILTERED]", "password"=&gt;"[FILTERED]"}, "commit"=&gt;"Register", "action"=&gt;"create", "authenticity_token"=&gt;"9efc03bcc37191d8a6dc3676e2e7890ecdfda0b5", "controller"=&gt;"users"}
  User Create (0.4ms)   INSERT INTO "users" ("name", "updated_at", "password_confirmation", "password", "created_at") VALUES('susan', '2009-01-02 11:02:33', 'verysecret', 'verysecret', '2009-01-02 11:02:33')
</pre>
<p>Maintenant, on peut voir que notre action <code>create</code> a mis <code>[FILTERED]</code> dans le log plutôt que le mot de passe soumis. Le paramètre logging filtrera n'importe quel paramètre dont le nom contient l'argument passé, ainsi dans notre cas, le champ <code>password_confirmation</code> est aussi filtré. Toutefois, on peut toujours voir le mot de passe dans la requête SQL dans le log. Ce n'est un problème que dans le mode développement puisque par défaut cette donnée n'est pas stockée adns les logs en mode production. Aussi, si nous hashons nos mots de passe avant de les stocker dans la base de données alors les mots de passe ne seront pas envoyé à la base de données en texte clair et ne seront pas consultables dans les logs.</p>