<p>ActiveRecord provides many different methods for performing calculations on models. To demonstrate this we&rsquo;ll use a <code>Task</code> model that has an integer field called <code>priority</code> and look at some of those methods in <code>script/console</code>. For each method the SQL generated by Rails is shown afterwards.</p>
<p>We can find the priority of the first task like this:</p>
<code class="terminal">
&gt;&gt; Task.first.priority
=&gt; 3
</code>
<code class="sql"> SELECT * FROM "tasks" LIMIT 1</code>

<p>What if we want the sum of the priority of all of the tasks?</p>
<code class="terminal">
&gt;&gt; Task.sum(:priority)
=&gt; 12
</code>
<code class="sql">SELECT sum("tasks".priority) AS sum_priority FROM "tasks"</code>

<p>We can even pass conditions:</p>
<code class="terminal">
&gt;&gt; Task.sum(:priority, :conditions =&gt; {:completed =&gt; false })
=&gt; 2
</code>
<code class="sql">SELECT sum("tasks".priority) AS sum_priority FROM "tasks" WHERE (completed="f")</code>

<p>As well as <code>sum</code> there are other methods, such as <code>minimum</code>, <code>maximum</code> and <code>average</code>:</p>
<code class="terminal">
&gt;&gt; Task.minimum(:priority)
=&gt; 2
</code>
<code class="sql">SELECT min("tasks".priority) AS min_priority FROM "tasks"</code>

<code class="terminal">
&gt;&gt; Task.maximum(:priority)
=&gt; 5
</code>
<code class="sql">SELECT max("tasks".priority) AS max_priority FROM "tasks"</code>

<code class="terminal">
&gt;&gt; Task.average(:priority).to_f
=&gt; 3.0
</code>
<code class="sql">SELECT avg("tasks".priority) AS avg_priority FROM "tasks"</code>

<p>The SQL generated by Rails when these methods are used makes them more efficent than calculating these values using Ruby to return all of the <code>Tasks</code> and calculate the values.</p>

<h3>Using the methods through associations.</h3>
<p>These methods are class methods so they can also be used through associations. If we have a <code>Project</code> model, which <code>has_many :tasks</code>, we can access these methods for the tasks in a specific project. Note that, as before, we can pass conditions to the <code>find</code>.</p>
<code class="terminal">
  &gt;&gt; project = Project.first
  =&gt; #&lt;Project id: 1, title: "A Project"&gt;
  &gt;&gt; project.tasks.sum(:priority, :conditions =&gt; {:completed =&gt; true})
  =&gt; 10
</code>

<p>This executes the SQL below</p>
<code class="sql">SELECT sum("tasks".priority) AS sum_priority FROM "tasks" WHERE ("tasks"."completed" = 't') AND ("tasks".project_id = 1)</code>